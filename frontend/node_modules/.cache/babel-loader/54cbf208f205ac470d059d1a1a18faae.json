{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/ruichunchen/my-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{observer}from'mobx-react';import UserStore from'../stores/UserStore';import LoginForm from'../components/LoginForm';import SubmitButton from'../components/SubmitButton';import Loading from'../components/loading';var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(){_classCallCheck(this,Login);return _super.apply(this,arguments);}_createClass(Login,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('/isLoggedIn',{method:'post',header:{'Accept':'application/json','Content-Type':'application/json'}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:result=_context.sent;if(result&&result.success){UserStore.loading=false;UserStore.isLoggedIn=true;UserStore.username=result.username;}else{UserStore.loading=false;UserStore.isLoggedIn=false;}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);UserStore.loading=false;UserStore.isLoggedIn=false;case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"doLogout\",value:function(){var _doLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch('/logout',{method:'post',header:{'Accept':'application/json','Content-Type':'application/json'}});case 3:res=_context2.sent;_context2.next=6;return res.json();case 6:result=_context2.sent;if(result&&result.success){UserStore.isLoggedIn=false;UserStore.username='';}_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));function doLogout(){return _doLogout.apply(this,arguments);}return doLogout;}()},{key:\"render\",value:function render(){var _this=this;if(UserStore.loading){return/*#__PURE__*/React.createElement(Loading,null);}else{if(UserStore.isLoggedIn){return/*#__PURE__*/React.createElement(\"div\",{className:\"app\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},\"Welcome \",UserStore.username,/*#__PURE__*/React.createElement(SubmitButton,{text:'Log Out',disabled:false,onClick:function onClick(){return _this.doLogout();}})));}}return/*#__PURE__*/React.createElement(\"div\",{className:\"login\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(LoginForm,null)));}}]);return Login;}(Component);export default observer(Login);","map":{"version":3,"sources":["/Users/ruichunchen/my-react/src/pages/Login.js"],"names":["React","Component","observer","UserStore","LoginForm","SubmitButton","Loading","Login","fetch","method","header","res","json","result","success","loading","isLoggedIn","username","console","log","doLogout"],"mappings":"y1BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,QAAT,KAAyB,YAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,qBAAtB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,4BAAzB,CACA,MAAOC,CAAAA,OAAP,KAAoB,uBAApB,C,GAEMC,CAAAA,K,qfAGsBC,CAAAA,KAAK,CAAC,aAAD,CAAgB,CACjCC,MAAM,CAAE,MADyB,CAEjCC,MAAM,CAAE,CACR,SAAU,kBADF,CAER,eAAgB,kBAFR,CAFyB,CAAhB,C,QAAjBC,G,qCAOeA,CAAAA,GAAG,CAACC,IAAJ,E,QAAfC,M,eACJ,GAAGA,MAAM,EAAIA,MAAM,CAACC,OAApB,CAA4B,CACxBX,SAAS,CAACY,OAAV,CAAoB,KAApB,CACAZ,SAAS,CAACa,UAAV,CAAuB,IAAvB,CACAb,SAAS,CAACc,QAAV,CAAqBJ,MAAM,CAACI,QAA5B,CACH,CAJD,IAIK,CACDd,SAAS,CAACY,OAAV,CAAoB,KAApB,CACAZ,SAAS,CAACa,UAAV,CAAuB,KAAvB,CACH,C,iFAEDb,SAAS,CAACY,OAAV,CAAoB,KAApB,CACAZ,SAAS,CAACa,UAAV,CAAuB,KAAvB,C,0dAMcR,CAAAA,KAAK,CAAC,SAAD,CAAY,CAC/BC,MAAM,CAAE,MADuB,CAE/BC,MAAM,CAAE,CACN,SAAU,kBADJ,CAEN,eAAgB,kBAFV,CAFuB,CAAZ,C,QAAjBC,G,uCAOeA,CAAAA,GAAG,CAACC,IAAJ,E,QAAfC,M,gBACJ,GAAGA,MAAM,EAAIA,MAAM,CAACC,OAApB,CAA4B,CAC1BX,SAAS,CAACa,UAAV,CAAuB,KAAvB,CACAb,SAAS,CAACc,QAAV,CAAqB,EAArB,CACD,C,qFAEDC,OAAO,CAACC,GAAR,e,gMAGG,gBACL,GAAGhB,SAAS,CAACY,OAAb,CAAqB,CACjB,mBAAO,oBAAC,OAAD,MAAP,CACH,CAFD,IAEK,CACD,GAAGZ,SAAS,CAACa,UAAb,CAAwB,CACpB,mBACI,2BAAK,SAAS,CAAC,KAAf,eACI,2BAAK,SAAS,CAAC,WAAf,aACab,SAAS,CAACc,QADvB,cAEI,oBAAC,YAAD,EACA,IAAI,CAAI,SADR,CAEA,QAAQ,CAAE,KAFV,CAGA,OAAO,CAAG,yBAAM,CAAA,KAAI,CAACG,QAAL,EAAN,EAHV,EAFJ,CADJ,CADJ,CAYH,CACJ,CACD,mBACI,2BAAK,SAAS,CAAC,OAAf,eACI,2BAAK,SAAS,CAAC,WAAf,eACI,oBAAC,SAAD,MADJ,CADJ,CADJ,CAOH,C,mBArEenB,S,EAuEpB,cAAeC,CAAAA,QAAQ,CAACK,KAAD,CAAvB","sourcesContent":["import React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport UserStore from '../stores/UserStore';\nimport LoginForm from '../components/LoginForm'\nimport SubmitButton from '../components/SubmitButton';\nimport Loading from '../components/loading';\n\nclass Login extends Component {\n    async componentDidMount() {\n        try{\n            let res = await fetch('/isLoggedIn', {\n                method: 'post',\n                header: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n                }\n            });\n            let result = await res.json();\n            if(result && result.success){\n                UserStore.loading = false;\n                UserStore.isLoggedIn = true;\n                UserStore.username = result.username;\n            }else{\n                UserStore.loading = false;\n                UserStore.isLoggedIn = false;\n            }\n        }catch(e){\n            UserStore.loading = false;\n            UserStore.isLoggedIn = false;\n        }\n    }\n    \n    async doLogout() {\n        try{\n          let res = await fetch('/logout', {\n            method: 'post',\n            header: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json'\n            }\n          });\n          let result = await res.json();\n          if(result && result.success){\n            UserStore.isLoggedIn = false;\n            UserStore.username = '';\n          }\n        }catch(e){\n          console.log(e);\n        }\n    }\n    render() {\n        if(UserStore.loading){\n            return <Loading />\n        }else{\n            if(UserStore.isLoggedIn){\n                return (\n                    <div className=\"app\">\n                        <div className=\"container\"> \n                            Welcome {UserStore.username}\n                            <SubmitButton \n                            text = {'Log Out'}\n                            disabled={false}\n                            onClick={ () => this.doLogout()}\n                            />\n                        </div>\n                    </div>\n                )\n            }\n        }\n        return (\n            <div className=\"login\">\n                <div className=\"container\">\n                    <LoginForm/>\n                </div>\n            </div>\n        )\n    }\n}\nexport default observer(Login);"]},"metadata":{},"sourceType":"module"}